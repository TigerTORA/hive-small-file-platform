app/engines/hive_partition_path_resolver.py
    M 189:4 HivePartitionPathResolver.get_partition_hdfs_path - C (14)
    M 81:4 HivePartitionPathResolver.partition_filter_to_spec - B (10)
    M 109:4 HivePartitionPathResolver.split_or_partition_filter - B (8)
    M 39:4 HivePartitionPathResolver._create_hive_connection - B (6)
    M 296:4 HivePartitionPathResolver._resolve_partition_path_fallback - B (6)
    C 18:0 HivePartitionPathResolver - A (5)
    M 126:4 HivePartitionPathResolver.validate_partition_filter - A (4)
    M 67:4 HivePartitionPathResolver._get_table_partitions - A (3)
    M 55:4 HivePartitionPathResolver._get_table_location - A (2)
    M 142:4 HivePartitionPathResolver.parse_partition_spec - A (2)
    M 158:4 HivePartitionPathResolver.format_partition_spec - A (2)
    M 169:4 HivePartitionPathResolver.generate_temp_partition_kv - A (2)
    M 21:4 HivePartitionPathResolver.__init__ - A (1)
    M 283:4 HivePartitionPathResolver.resolve_partition_path - A (1)
app/engines/hive_partition_merge_executor.py
    M 388:4 HivePartitionMergeExecutor.execute_full_table_dynamic_partition_merge - C (14)
    M 39:4 HivePartitionMergeExecutor.execute_partition_native_merge - C (12)
    M 178:4 HivePartitionMergeExecutor.execute_single_partition_native_merge - B (10)
    C 24:0 HivePartitionMergeExecutor - B (9)
    M 630:4 HivePartitionMergeExecutor._get_non_partition_columns - B (8)
    M 676:4 HivePartitionMergeExecutor._get_dynamic_partition_settings - B (6)
    M 27:4 HivePartitionMergeExecutor.__init__ - A (1)
app/engines/safe_hive_metadata_manager.py
    M 272:4 SafeHiveMetadataManager._get_table_columns - C (18)
    M 207:4 SafeHiveMetadataManager._get_table_format_info - C (15)
    M 322:4 SafeHiveMetadataManager._is_unsupported_table_type - C (15)
    M 363:4 SafeHiveMetadataManager._unsupported_reason - C (15)
    M 419:4 SafeHiveMetadataManager._infer_table_compression - C (11)
    C 23:0 SafeHiveMetadataManager - B (9)
    M 81:4 SafeHiveMetadataManager._create_hive_connection - B (6)
    M 153:4 SafeHiveMetadataManager._is_partitioned_table - B (6)
    M 400:4 SafeHiveMetadataManager._infer_storage_format_name - B (6)
    M 184:4 SafeHiveMetadataManager._get_table_partitions - A (3)
    M 112:4 SafeHiveMetadataManager._get_table_location - A (2)
    M 131:4 SafeHiveMetadataManager._table_exists - A (2)
    M 70:4 SafeHiveMetadataManager.__init__ - A (1)
app/engines/safe_hive_temp_table.py
    M 114:4 HiveTempTableManager._create_temp_table_with_logging - F (44)
    C 20:0 HiveTempTableManager - B (9)
    M 34:4 HiveTempTableManager._create_hive_connection - B (6)
    M 60:4 HiveTempTableManager._create_temp_table - A (4)
    M 400:4 HiveTempTableManager._validate_temp_table_data - A (4)
    M 23:4 HiveTempTableManager.__init__ - A (1)
    M 50:4 HiveTempTableManager._generate_temp_table_name - A (1)
    M 55:4 HiveTempTableManager._generate_backup_table_name - A (1)
app/engines/merge_progress_tracker.py
    M 231:4 MergeProgressTracker._generate_recommendations - B (8)
    M 170:4 MergeProgressTracker._assess_merge_risks - B (7)
    M 91:4 MergeProgressTracker._get_current_file_stats - B (6)
    C 15:0 MergeProgressTracker - A (5)
    M 65:4 MergeProgressTracker.estimate_duration - A (4)
    M 131:4 MergeProgressTracker._estimate_merge_result - A (3)
    M 287:4 MergeProgressTracker._get_file_count - A (3)
    M 21:4 MergeProgressTracker.get_merge_preview - A (2)
    M 306:4 MergeProgressTracker._get_table_location - A (2)
    M 18:4 MergeProgressTracker.__init__ - A (1)
app/engines/demo_merge_engine.py
    M 383:4 DemoMergeEngine._update_task_progress - B (9)
    C 23:0 DemoMergeEngine - B (7)
    M 41:4 DemoMergeEngine.execute_merge - B (7)
    M 339:4 DemoMergeEngine._get_real_file_count - B (7)
    M 315:4 DemoMergeEngine._test_connections - A (5)
    M 26:4 DemoMergeEngine.__init__ - A (2)
app/engines/safe_hive_atomic_swap.py
    M 70:4 HiveAtomicSwapManager._test_connections - D (29)
    M 485:4 HiveAtomicSwapManager._atomic_swap_table_location - B (9)
    C 24:0 HiveAtomicSwapManager - B (7)
    M 54:4 HiveAtomicSwapManager._create_hive_connection - B (6)
    M 619:4 HiveAtomicSwapManager._hdfs_rename_with_fallback - B (6)
    M 690:4 HiveAtomicSwapManager._rollback_merge - A (3)
    M 249:4 HiveAtomicSwapManager._execute_sql_with_heartbeat - A (2)
    M 369:4 HiveAtomicSwapManager._atomic_table_swap - A (2)
    M 406:4 HiveAtomicSwapManager._atomic_table_swap_with_logging - A (2)
    M 27:4 HiveAtomicSwapManager.__init__ - A (1)
app/engines/base_engine.py
    M 128:4 BaseMergeEngine.update_task_status - B (10)
    C 11:0 BaseMergeEngine - A (3)
    M 65:4 BaseMergeEngine.log_task_event - A (3)
    M 17:4 BaseMergeEngine.__init__ - A (1)
    M 21:4 BaseMergeEngine.validate_task - A (1)
    M 32:4 BaseMergeEngine.execute_merge - A (1)
    M 44:4 BaseMergeEngine.get_merge_preview - A (1)
    M 55:4 BaseMergeEngine.estimate_duration - A (1)
    M 169:4 BaseMergeEngine._build_table_path - A (1)
app/engines/connection_manager.py
    M 94:4 HiveConnectionManager._create_hive_connection - A (5)
    C 20:0 HiveConnectionManager - A (4)
    M 23:4 HiveConnectionManager.__init__ - A (4)
    M 42:4 HiveConnectionManager._init_hive_password - A (4)
    M 65:4 HiveConnectionManager.test_connections - A (4)
    M 125:4 HiveConnectionManager.cleanup_connections - A (4)
    M 119:4 HiveConnectionManager.get_hive_connection - A (2)
    M 140:4 HiveConnectionManager.__enter__ - A (1)
    M 143:4 HiveConnectionManager.__exit__ - A (1)
app/engines/safe_hive_engine_refactored.py
    C 22:0 SafeHiveMergeEngine - A (2)
    M 83:4 SafeHiveMergeEngine.__exit__ - A (2)
    M 28:4 SafeHiveMergeEngine.__init__ - A (1)
    M 37:4 SafeHiveMergeEngine.set_progress_callback - A (1)
    M 41:4 SafeHiveMergeEngine.validate_task - A (1)
    M 45:4 SafeHiveMergeEngine.execute_merge - A (1)
    M 49:4 SafeHiveMergeEngine.get_merge_preview - A (1)
    M 53:4 SafeHiveMergeEngine.estimate_duration - A (1)
    M 58:4 SafeHiveMergeEngine._execute_concatenate - A (1)
    M 65:4 SafeHiveMergeEngine._execute_insert_overwrite - A (1)
    M 72:4 SafeHiveMergeEngine._execute_safe_merge - A (1)
    M 79:4 SafeHiveMergeEngine.__enter__ - A (1)
app/engines/engine_factory.py
    M 62:4 MergeEngineFactory.recommend_strategy - B (9)
    M 234:4 MergeEngineFactory._get_strategy_reason - B (9)
    M 111:4 MergeEngineFactory.validate_strategy_compatibility - B (7)
    C 8:0 MergeEngineFactory - B (6)
    M 168:4 MergeEngineFactory.create_smart_merge_task - B (6)
    M 18:4 MergeEngineFactory.get_engine - A (1)
    M 36:4 MergeEngineFactory.get_engine_capabilities - A (1)
app/engines/safe_hive_utils.py
    C 12:0 HiveEngineUtils - B (10)
    M 43:4 HiveEngineUtils.extract_error_detail - B (10)
    M 123:4 HiveEngineUtils.get_format_classes - B (7)
app/engines/safe_hive_engine.py
    M 298:4 SafeHiveMergeEngine.execute_merge - F (57)
    M 2294:4 SafeHiveMergeEngine._create_temp_table_with_logging - F (41)
    M 1153:4 SafeHiveMergeEngine._test_connections - D (29)
    M 3044:4 SafeHiveMergeEngine._execute_full_table_dynamic_partition_merge - C (19)
    M 1523:4 SafeHiveMergeEngine._get_partition_hdfs_path - C (14)
    M 1421:4 SafeHiveMergeEngine._update_active_table_format - C (13)
    M 2892:4 SafeHiveMergeEngine._parse_table_schema_from_show_create - C (13)
    M 2780:4 SafeHiveMergeEngine._get_partition_columns - C (12)
    M 3757:4 SafeHiveMergeEngine._execute_partition_native_merge - C (12)
    M 1049:4 SafeHiveMergeEngine.get_merge_preview - C (11)
    M 99:4 SafeHiveMergeEngine._extract_error_detail - B (10)
    M 234:4 SafeHiveMergeEngine.validate_task - B (10)
    M 1370:4 SafeHiveMergeEngine._apply_output_settings - B (10)
    M 1478:4 SafeHiveMergeEngine._partition_filter_to_spec - B (10)
    M 3898:4 SafeHiveMergeEngine._execute_single_partition_native_merge - B (10)
    M 197:4 SafeHiveMergeEngine._update_task_progress - B (9)
    M 3453:4 SafeHiveMergeEngine._atomic_swap_table_location - B (9)
    C 27:0 SafeHiveMergeEngine - B (8)
    M 1506:4 SafeHiveMergeEngine._split_or_partition_filter - B (8)
    M 2833:4 SafeHiveMergeEngine._list_all_partitions - B (8)
    M 3711:4 SafeHiveMergeEngine._get_non_partition_columns - B (8)
    M 61:4 SafeHiveMergeEngine.__init__ - B (7)
    M 1333:4 SafeHiveMergeEngine._create_hive_connection - B (6)
    M 1617:4 SafeHiveMergeEngine._resolve_partition_path_fallback - B (6)
    M 1856:4 SafeHiveMergeEngine._calculate_job_compression - B (6)
    M 2020:4 SafeHiveMergeEngine._hdfs_rename_with_fallback - B (6)
    M 1713:4 SafeHiveMergeEngine._determine_target_format - A (5)
    M 1822:4 SafeHiveMergeEngine._calculate_effective_meta_compression - A (5)
    M 2131:4 SafeHiveMergeEngine._get_file_count - A (5)
    M 2176:4 SafeHiveMergeEngine._get_temp_table_file_count - A (5)
    M 2234:4 SafeHiveMergeEngine._get_file_count_with_logging - A (5)
    M 3635:4 SafeHiveMergeEngine._wait_for_partition_data - A (5)
    M 1353:4 SafeHiveMergeEngine._cleanup_connections - A (4)
    M 1667:4 SafeHiveMergeEngine._validate_partition_filter - A (4)
    M 1881:4 SafeHiveMergeEngine._create_temp_table - A (4)
    M 1935:4 SafeHiveMergeEngine._validate_temp_table_data - A (4)
    M 3618:4 SafeHiveMergeEngine._count_partition_files - A (4)
    M 1730:4 SafeHiveMergeEngine._normalize_compression_preference - A (3)
    M 1775:4 SafeHiveMergeEngine._extract_parent_directory - A (3)
    M 2091:4 SafeHiveMergeEngine._rollback_merge - A (3)
    M 191:4 SafeHiveMergeEngine._report_progress - A (2)
    M 1131:4 SafeHiveMergeEngine.estimate_duration - A (2)
    M 1754:4 SafeHiveMergeEngine._should_use_dynamic_partition_merge - A (2)
    M 1802:4 SafeHiveMergeEngine._build_shadow_root_path - A (2)
    M 1983:4 SafeHiveMergeEngine._atomic_table_swap - A (2)
    M 2219:4 SafeHiveMergeEngine._get_file_count_fallback - A (2)
    M 2576:4 SafeHiveMergeEngine._execute_sql_with_heartbeat - A (2)
    M 2700:4 SafeHiveMergeEngine._atomic_table_swap_with_logging - A (2)
    M 2874:4 SafeHiveMergeEngine._parse_partition_spec - A (2)
    M 2993:4 SafeHiveMergeEngine._get_format_classes - A (2)
    M 3587:4 SafeHiveMergeEngine._generate_temp_partition_kv - A (2)
    M 3607:4 SafeHiveMergeEngine._format_partition_spec - A (2)
    M 3680:4 SafeHiveMergeEngine._cleanup_temp_partition - A (2)
    M 95:4 SafeHiveMergeEngine.set_progress_callback - A (1)
    M 176:4 SafeHiveMergeEngine._execute_concatenate - A (1)
    M 181:4 SafeHiveMergeEngine._execute_insert_overwrite - A (1)
    M 186:4 SafeHiveMergeEngine._execute_safe_merge - A (1)
    M 1654:4 SafeHiveMergeEngine._resolve_partition_path - A (1)
    M 1683:4 SafeHiveMergeEngine._generate_temp_table_name - A (1)
    M 1688:4 SafeHiveMergeEngine._generate_backup_table_name - A (1)
    M 1693:4 SafeHiveMergeEngine._init_merge_result_dict - A (1)
app/engines/safe_hive_file_counter.py
    M 39:4 HiveFileCounter._create_hive_connection - B (6)
    C 18:0 HiveFileCounter - A (5)
    M 58:4 HiveFileCounter._get_file_count - A (5)
    M 103:4 HiveFileCounter._get_file_count_with_logging - A (5)
    M 178:4 HiveFileCounter._get_temp_table_file_count - A (5)
    M 238:4 HiveFileCounter._wait_for_partition_data - A (5)
    M 221:4 HiveFileCounter._count_partition_files - A (4)
    M 163:4 HiveFileCounter._get_file_count_fallback - A (2)
    M 283:4 HiveFileCounter._cleanup_temp_partition - A (2)
    M 21:4 HiveFileCounter.__init__ - A (1)
app/engines/real_hive_engine.py
    M 536:4 RealHiveMergeEngine._create_real_hive_connection - C (13)
    M 1162:4 RealHiveMergeEngine.get_merge_preview - C (12)
    M 75:4 RealHiveMergeEngine._update_task_progress - B (9)
    M 112:4 RealHiveMergeEngine.validate_task - B (9)
    M 29:4 RealHiveMergeEngine.__init__ - B (7)
    M 732:4 RealHiveMergeEngine._create_real_temp_table_with_logging - B (7)
    M 169:4 RealHiveMergeEngine.execute_merge - B (6)
    M 507:4 RealHiveMergeEngine._test_connections - B (6)
    M 610:4 RealHiveMergeEngine._is_partitioned_table - B (6)
    C 22:0 RealHiveMergeEngine - A (5)
    M 632:4 RealHiveMergeEngine._validate_partition_filter - A (5)
    M 673:4 RealHiveMergeEngine._get_real_file_count_with_logging - A (5)
    M 988:4 RealHiveMergeEngine._get_real_temp_table_file_count - A (5)
    M 935:4 RealHiveMergeEngine._validate_real_temp_table_data - A (4)
    M 1109:4 RealHiveMergeEngine._rollback_real_merge - A (3)
    M 1152:4 RealHiveMergeEngine._cleanup_connections - A (3)
    M 69:4 RealHiveMergeEngine._report_progress - A (2)
    M 596:4 RealHiveMergeEngine._table_exists - A (2)
    M 663:4 RealHiveMergeEngine._get_table_location - A (2)
    M 827:4 RealHiveMergeEngine._execute_sql_with_heartbeat - A (2)
    M 1029:4 RealHiveMergeEngine._real_atomic_table_swap_with_logging - A (2)
    M 1251:4 RealHiveMergeEngine.estimate_duration - A (2)
    M 65:4 RealHiveMergeEngine.set_progress_callback - A (1)
    M 653:4 RealHiveMergeEngine._generate_temp_table_name - A (1)
    M 658:4 RealHiveMergeEngine._generate_backup_table_name - A (1)
app/engines/merge_executor.py
    M 129:4 MergeTaskExecutor._execute_unified_merge_impl - C (18)
    M 305:4 MergeTaskExecutor._get_table_path - C (11)
    M 336:4 MergeTaskExecutor._get_table_format - B (9)
    M 369:4 MergeTaskExecutor._update_task_progress - B (9)
    C 22:0 MergeTaskExecutor - B (7)
    M 34:4 MergeTaskExecutor.execute_merge - A (5)
    M 406:4 MergeTaskExecutor._partition_filter_to_spec - A (4)
    M 420:4 MergeTaskExecutor._resolve_partition_path - A (4)
    M 437:4 MergeTaskExecutor._validate_shadow_directory - A (4)
    M 363:4 MergeTaskExecutor._report_progress - A (2)
    M 25:4 MergeTaskExecutor.__init__ - A (1)
    M 30:4 MergeTaskExecutor.set_progress_callback - A (1)
app/engines/safe_hive_engine_original_backup.py
    M 294:4 SafeHiveMergeEngine.execute_merge - F (76)
    M 2389:4 SafeHiveMergeEngine._create_temp_table_with_logging - F (44)
    M 1197:4 SafeHiveMergeEngine._test_connections - D (29)
    M 3170:4 SafeHiveMergeEngine._execute_full_table_dynamic_partition_merge - C (19)
    M 1720:4 SafeHiveMergeEngine._get_table_columns - C (18)
    M 1466:4 SafeHiveMergeEngine._get_table_format_info - C (15)
    M 1659:4 SafeHiveMergeEngine._is_unsupported_table_type - C (15)
    M 1692:4 SafeHiveMergeEngine._unsupported_reason - C (15)
    M 1806:4 SafeHiveMergeEngine._get_partition_hdfs_path - C (14)
    M 1605:4 SafeHiveMergeEngine._update_active_table_format - C (13)
    M 3018:4 SafeHiveMergeEngine._parse_table_schema_from_show_create - C (13)
    M 2906:4 SafeHiveMergeEngine._get_partition_columns - C (12)
    M 3757:4 SafeHiveMergeEngine._execute_partition_native_merge - C (12)
    M 1093:4 SafeHiveMergeEngine.get_merge_preview - C (11)
    M 1528:4 SafeHiveMergeEngine._infer_table_compression - C (11)
    M 95:4 SafeHiveMergeEngine._extract_error_detail - B (10)
    M 230:4 SafeHiveMergeEngine.validate_task - B (10)
    M 1554:4 SafeHiveMergeEngine._apply_output_settings - B (10)
    M 1761:4 SafeHiveMergeEngine._partition_filter_to_spec - B (10)
    M 3898:4 SafeHiveMergeEngine._execute_single_partition_native_merge - B (10)
    C 26:0 SafeHiveMergeEngine - B (9)
    M 193:4 SafeHiveMergeEngine._update_task_progress - B (9)
    M 3453:4 SafeHiveMergeEngine._atomic_swap_table_location - B (9)
    M 1789:4 SafeHiveMergeEngine._split_or_partition_filter - B (8)
    M 2959:4 SafeHiveMergeEngine._list_all_partitions - B (8)
    M 3711:4 SafeHiveMergeEngine._get_non_partition_columns - B (8)
    M 60:4 SafeHiveMergeEngine.__init__ - B (7)
    M 1386:4 SafeHiveMergeEngine._create_hive_connection - B (6)
    M 1430:4 SafeHiveMergeEngine._is_partitioned_table - B (6)
    M 1518:4 SafeHiveMergeEngine._infer_storage_format_name - B (6)
    M 1900:4 SafeHiveMergeEngine._resolve_partition_path_fallback - B (6)
    M 2115:4 SafeHiveMergeEngine._hdfs_rename_with_fallback - B (6)
    M 2226:4 SafeHiveMergeEngine._get_file_count - A (5)
    M 2271:4 SafeHiveMergeEngine._get_temp_table_file_count - A (5)
    M 2329:4 SafeHiveMergeEngine._get_file_count_with_logging - A (5)
    M 3635:4 SafeHiveMergeEngine._wait_for_partition_data - A (5)
    M 1406:4 SafeHiveMergeEngine._cleanup_connections - A (4)
    M 1950:4 SafeHiveMergeEngine._validate_partition_filter - A (4)
    M 1976:4 SafeHiveMergeEngine._create_temp_table - A (4)
    M 2030:4 SafeHiveMergeEngine._validate_temp_table_data - A (4)
    M 3618:4 SafeHiveMergeEngine._count_partition_files - A (4)
    M 1452:4 SafeHiveMergeEngine._get_table_partitions - A (3)
    M 2186:4 SafeHiveMergeEngine._rollback_merge - A (3)
    M 2874:4 SafeHiveMergeEngine._is_partitioned_table - A (3)
    M 187:4 SafeHiveMergeEngine._report_progress - A (2)
    M 1175:4 SafeHiveMergeEngine.estimate_duration - A (2)
    M 1376:4 SafeHiveMergeEngine._get_table_location - A (2)
    M 1417:4 SafeHiveMergeEngine._table_exists - A (2)
    M 2078:4 SafeHiveMergeEngine._atomic_table_swap - A (2)
    M 2314:4 SafeHiveMergeEngine._get_file_count_fallback - A (2)
    M 2675:4 SafeHiveMergeEngine._execute_sql_with_heartbeat - A (2)
    M 2795:4 SafeHiveMergeEngine._atomic_table_swap_with_logging - A (2)
    M 3000:4 SafeHiveMergeEngine._parse_partition_spec - A (2)
    M 3119:4 SafeHiveMergeEngine._get_format_classes - A (2)
    M 3587:4 SafeHiveMergeEngine._generate_temp_partition_kv - A (2)
    M 3607:4 SafeHiveMergeEngine._format_partition_spec - A (2)
    M 3680:4 SafeHiveMergeEngine._cleanup_temp_partition - A (2)
    M 91:4 SafeHiveMergeEngine.set_progress_callback - A (1)
    M 172:4 SafeHiveMergeEngine._execute_concatenate - A (1)
    M 177:4 SafeHiveMergeEngine._execute_insert_overwrite - A (1)
    M 182:4 SafeHiveMergeEngine._execute_safe_merge - A (1)
    M 1937:4 SafeHiveMergeEngine._resolve_partition_path - A (1)
    M 1966:4 SafeHiveMergeEngine._generate_temp_table_name - A (1)
    M 1971:4 SafeHiveMergeEngine._generate_backup_table_name - A (1)
app/engines/validation_service.py
    M 120:4 MergeTaskValidationService._is_unsupported_table_type - C (14)
    M 21:4 MergeTaskValidationService.validate_task - B (9)
    M 159:4 MergeTaskValidationService._unsupported_reason - B (8)
    M 202:4 MergeTaskValidationService.get_table_columns - B (7)
    C 15:0 MergeTaskValidationService - B (6)
    M 179:4 MergeTaskValidationService._validate_partition_filter - A (5)
    M 97:4 MergeTaskValidationService._get_table_partitions - A (3)
    M 75:4 MergeTaskValidationService._table_exists - A (2)
    M 87:4 MergeTaskValidationService._is_partitioned_table - A (2)
    M 109:4 MergeTaskValidationService._get_table_format_info - A (2)
    M 18:4 MergeTaskValidationService.__init__ - A (1)

291 blocks (classes, functions, methods) analyzed.
Average complexity: B (6.381443298969073)
