{"app/engines/hive_partition_path_resolver.py": [{"type": "method", "rank": "C", "lineno": 189, "complexity": 14, "classname": "HivePartitionPathResolver", "endline": 280, "name": "get_partition_hdfs_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 81, "complexity": 10, "classname": "HivePartitionPathResolver", "endline": 107, "name": "partition_filter_to_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 109, "complexity": 8, "classname": "HivePartitionPathResolver", "endline": 124, "name": "split_or_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 39, "complexity": 6, "classname": "HivePartitionPathResolver", "endline": 53, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 296, "complexity": 6, "classname": "HivePartitionPathResolver", "endline": 331, "name": "_resolve_partition_path_fallback", "col_offset": 4, "closures": []}, {"type": "class", "rank": "A", "lineno": 18, "complexity": 5, "endline": 331, "name": "HivePartitionPathResolver", "col_offset": 0, "methods": [{"type": "method", "rank": "A", "lineno": 21, "complexity": 1, "classname": "HivePartitionPathResolver", "endline": 37, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 39, "complexity": 6, "classname": "HivePartitionPathResolver", "endline": 53, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 55, "complexity": 2, "classname": "HivePartitionPathResolver", "endline": 65, "name": "_get_table_location", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 67, "complexity": 3, "classname": "HivePartitionPathResolver", "endline": 79, "name": "_get_table_partitions", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 81, "complexity": 10, "classname": "HivePartitionPathResolver", "endline": 107, "name": "partition_filter_to_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 109, "complexity": 8, "classname": "HivePartitionPathResolver", "endline": 124, "name": "split_or_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 126, "complexity": 4, "classname": "HivePartitionPathResolver", "endline": 140, "name": "validate_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 142, "complexity": 2, "classname": "HivePartitionPathResolver", "endline": 156, "name": "parse_partition_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 158, "complexity": 2, "classname": "HivePartitionPathResolver", "endline": 167, "name": "format_partition_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 169, "complexity": 2, "classname": "HivePartitionPathResolver", "endline": 187, "name": "generate_temp_partition_kv", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 189, "complexity": 14, "classname": "HivePartitionPathResolver", "endline": 280, "name": "get_partition_hdfs_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 283, "complexity": 1, "classname": "HivePartitionPathResolver", "endline": 294, "name": "resolve_partition_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 296, "complexity": 6, "classname": "HivePartitionPathResolver", "endline": 331, "name": "_resolve_partition_path_fallback", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 126, "complexity": 4, "classname": "HivePartitionPathResolver", "endline": 140, "name": "validate_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 67, "complexity": 3, "classname": "HivePartitionPathResolver", "endline": 79, "name": "_get_table_partitions", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 55, "complexity": 2, "classname": "HivePartitionPathResolver", "endline": 65, "name": "_get_table_location", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 142, "complexity": 2, "classname": "HivePartitionPathResolver", "endline": 156, "name": "parse_partition_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 158, "complexity": 2, "classname": "HivePartitionPathResolver", "endline": 167, "name": "format_partition_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 169, "complexity": 2, "classname": "HivePartitionPathResolver", "endline": 187, "name": "generate_temp_partition_kv", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 21, "complexity": 1, "classname": "HivePartitionPathResolver", "endline": 37, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 283, "complexity": 1, "classname": "HivePartitionPathResolver", "endline": 294, "name": "resolve_partition_path", "col_offset": 4, "closures": []}], "app/engines/hive_partition_merge_executor.py": [{"type": "method", "rank": "C", "lineno": 388, "complexity": 14, "classname": "HivePartitionMergeExecutor", "endline": 628, "name": "execute_full_table_dynamic_partition_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 39, "complexity": 12, "classname": "HivePartitionMergeExecutor", "endline": 176, "name": "execute_partition_native_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 178, "complexity": 10, "classname": "HivePartitionMergeExecutor", "endline": 386, "name": "execute_single_partition_native_merge", "col_offset": 4, "closures": []}, {"type": "class", "rank": "B", "lineno": 24, "complexity": 9, "endline": 720, "name": "HivePartitionMergeExecutor", "col_offset": 0, "methods": [{"type": "method", "rank": "A", "lineno": 27, "complexity": 1, "classname": "HivePartitionMergeExecutor", "endline": 37, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 39, "complexity": 12, "classname": "HivePartitionMergeExecutor", "endline": 176, "name": "execute_partition_native_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 178, "complexity": 10, "classname": "HivePartitionMergeExecutor", "endline": 386, "name": "execute_single_partition_native_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 388, "complexity": 14, "classname": "HivePartitionMergeExecutor", "endline": 628, "name": "execute_full_table_dynamic_partition_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 630, "complexity": 8, "classname": "HivePartitionMergeExecutor", "endline": 674, "name": "_get_non_partition_columns", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 676, "complexity": 6, "classname": "HivePartitionMergeExecutor", "endline": 720, "name": "_get_dynamic_partition_settings", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 630, "complexity": 8, "classname": "HivePartitionMergeExecutor", "endline": 674, "name": "_get_non_partition_columns", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 676, "complexity": 6, "classname": "HivePartitionMergeExecutor", "endline": 720, "name": "_get_dynamic_partition_settings", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 27, "complexity": 1, "classname": "HivePartitionMergeExecutor", "endline": 37, "name": "__init__", "col_offset": 4, "closures": []}], "app/engines/safe_hive_metadata_manager.py": [{"type": "method", "rank": "C", "lineno": 272, "complexity": 18, "classname": "SafeHiveMetadataManager", "endline": 320, "name": "_get_table_columns", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 207, "complexity": 15, "classname": "SafeHiveMetadataManager", "endline": 270, "name": "_get_table_format_info", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 322, "complexity": 15, "classname": "SafeHiveMetadataManager", "endline": 361, "name": "_is_unsupported_table_type", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 363, "complexity": 15, "classname": "SafeHiveMetadataManager", "endline": 398, "name": "_unsupported_reason", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 419, "complexity": 11, "classname": "SafeHiveMetadataManager", "endline": 453, "name": "_infer_table_compression", "col_offset": 4, "closures": []}, {"type": "class", "rank": "B", "lineno": 23, "complexity": 9, "endline": 453, "name": "SafeHiveMetadataManager", "col_offset": 0, "methods": [{"type": "method", "rank": "A", "lineno": 70, "complexity": 1, "classname": "SafeHiveMetadataManager", "endline": 79, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 81, "complexity": 6, "classname": "SafeHiveMetadataManager", "endline": 107, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 112, "complexity": 2, "classname": "SafeHiveMetadataManager", "endline": 129, "name": "_get_table_location", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 131, "complexity": 2, "classname": "SafeHiveMetadataManager", "endline": 151, "name": "_table_exists", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 153, "complexity": 6, "classname": "SafeHiveMetadataManager", "endline": 182, "name": "_is_partitioned_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 184, "complexity": 3, "classname": "SafeHiveMetadataManager", "endline": 205, "name": "_get_table_partitions", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 207, "complexity": 15, "classname": "SafeHiveMetadataManager", "endline": 270, "name": "_get_table_format_info", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 272, "complexity": 18, "classname": "SafeHiveMetadataManager", "endline": 320, "name": "_get_table_columns", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 322, "complexity": 15, "classname": "SafeHiveMetadataManager", "endline": 361, "name": "_is_unsupported_table_type", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 363, "complexity": 15, "classname": "SafeHiveMetadataManager", "endline": 398, "name": "_unsupported_reason", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 400, "complexity": 6, "classname": "SafeHiveMetadataManager", "endline": 417, "name": "_infer_storage_format_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 419, "complexity": 11, "classname": "SafeHiveMetadataManager", "endline": 453, "name": "_infer_table_compression", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 81, "complexity": 6, "classname": "SafeHiveMetadataManager", "endline": 107, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 153, "complexity": 6, "classname": "SafeHiveMetadataManager", "endline": 182, "name": "_is_partitioned_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 400, "complexity": 6, "classname": "SafeHiveMetadataManager", "endline": 417, "name": "_infer_storage_format_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 184, "complexity": 3, "classname": "SafeHiveMetadataManager", "endline": 205, "name": "_get_table_partitions", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 112, "complexity": 2, "classname": "SafeHiveMetadataManager", "endline": 129, "name": "_get_table_location", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 131, "complexity": 2, "classname": "SafeHiveMetadataManager", "endline": 151, "name": "_table_exists", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 70, "complexity": 1, "classname": "SafeHiveMetadataManager", "endline": 79, "name": "__init__", "col_offset": 4, "closures": []}], "app/engines/safe_hive_temp_table.py": [{"type": "method", "rank": "F", "lineno": 114, "complexity": 44, "classname": "HiveTempTableManager", "endline": 398, "name": "_create_temp_table_with_logging", "col_offset": 4, "closures": []}, {"type": "class", "rank": "B", "lineno": 20, "complexity": 9, "endline": 446, "name": "HiveTempTableManager", "col_offset": 0, "methods": [{"type": "method", "rank": "A", "lineno": 23, "complexity": 1, "classname": "HiveTempTableManager", "endline": 32, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 34, "complexity": 6, "classname": "HiveTempTableManager", "endline": 48, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 50, "complexity": 1, "classname": "HiveTempTableManager", "endline": 53, "name": "_generate_temp_table_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 55, "complexity": 1, "classname": "HiveTempTableManager", "endline": 58, "name": "_generate_backup_table_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 60, "complexity": 4, "classname": "HiveTempTableManager", "endline": 112, "name": "_create_temp_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "F", "lineno": 114, "complexity": 44, "classname": "HiveTempTableManager", "endline": 398, "name": "_create_temp_table_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 400, "complexity": 4, "classname": "HiveTempTableManager", "endline": 446, "name": "_validate_temp_table_data", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 34, "complexity": 6, "classname": "HiveTempTableManager", "endline": 48, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 60, "complexity": 4, "classname": "HiveTempTableManager", "endline": 112, "name": "_create_temp_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 400, "complexity": 4, "classname": "HiveTempTableManager", "endline": 446, "name": "_validate_temp_table_data", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 23, "complexity": 1, "classname": "HiveTempTableManager", "endline": 32, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 50, "complexity": 1, "classname": "HiveTempTableManager", "endline": 53, "name": "_generate_temp_table_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 55, "complexity": 1, "classname": "HiveTempTableManager", "endline": 58, "name": "_generate_backup_table_name", "col_offset": 4, "closures": []}], "app/engines/merge_progress_tracker.py": [{"type": "method", "rank": "B", "lineno": 231, "complexity": 8, "classname": "MergeProgressTracker", "endline": 285, "name": "_generate_recommendations", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 170, "complexity": 7, "classname": "MergeProgressTracker", "endline": 229, "name": "_assess_merge_risks", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 91, "complexity": 6, "classname": "MergeProgressTracker", "endline": 129, "name": "_get_current_file_stats", "col_offset": 4, "closures": []}, {"type": "class", "rank": "A", "lineno": 15, "complexity": 5, "endline": 314, "name": "MergeProgressTracker", "col_offset": 0, "methods": [{"type": "method", "rank": "A", "lineno": 18, "complexity": 1, "classname": "MergeProgressTracker", "endline": 19, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 21, "complexity": 2, "classname": "MergeProgressTracker", "endline": 61, "name": "get_merge_preview", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 65, "complexity": 4, "classname": "MergeProgressTracker", "endline": 89, "name": "estimate_duration", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 91, "complexity": 6, "classname": "MergeProgressTracker", "endline": 129, "name": "_get_current_file_stats", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 131, "complexity": 3, "classname": "MergeProgressTracker", "endline": 168, "name": "_estimate_merge_result", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 170, "complexity": 7, "classname": "MergeProgressTracker", "endline": 229, "name": "_assess_merge_risks", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 231, "complexity": 8, "classname": "MergeProgressTracker", "endline": 285, "name": "_generate_recommendations", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 287, "complexity": 3, "classname": "MergeProgressTracker", "endline": 304, "name": "_get_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 306, "complexity": 2, "classname": "MergeProgressTracker", "endline": 314, "name": "_get_table_location", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 65, "complexity": 4, "classname": "MergeProgressTracker", "endline": 89, "name": "estimate_duration", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 131, "complexity": 3, "classname": "MergeProgressTracker", "endline": 168, "name": "_estimate_merge_result", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 287, "complexity": 3, "classname": "MergeProgressTracker", "endline": 304, "name": "_get_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 21, "complexity": 2, "classname": "MergeProgressTracker", "endline": 61, "name": "get_merge_preview", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 306, "complexity": 2, "classname": "MergeProgressTracker", "endline": 314, "name": "_get_table_location", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 18, "complexity": 1, "classname": "MergeProgressTracker", "endline": 19, "name": "__init__", "col_offset": 4, "closures": []}], "app/engines/demo_merge_engine.py": [{"type": "method", "rank": "B", "lineno": 383, "complexity": 9, "classname": "DemoMergeEngine", "endline": 418, "name": "_update_task_progress", "col_offset": 4, "closures": []}, {"type": "class", "rank": "B", "lineno": 23, "complexity": 7, "endline": 418, "name": "DemoMergeEngine", "col_offset": 0, "methods": [{"type": "method", "rank": "A", "lineno": 26, "complexity": 2, "classname": "DemoMergeEngine", "endline": 39, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 41, "complexity": 7, "classname": "DemoMergeEngine", "endline": 313, "name": "execute_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 315, "complexity": 5, "classname": "DemoMergeEngine", "endline": 337, "name": "_test_connections", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 339, "complexity": 7, "classname": "DemoMergeEngine", "endline": 381, "name": "_get_real_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 383, "complexity": 9, "classname": "DemoMergeEngine", "endline": 418, "name": "_update_task_progress", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 41, "complexity": 7, "classname": "DemoMergeEngine", "endline": 313, "name": "execute_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 339, "complexity": 7, "classname": "DemoMergeEngine", "endline": 381, "name": "_get_real_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 315, "complexity": 5, "classname": "DemoMergeEngine", "endline": 337, "name": "_test_connections", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 26, "complexity": 2, "classname": "DemoMergeEngine", "endline": 39, "name": "__init__", "col_offset": 4, "closures": []}], "app/engines/safe_hive_atomic_swap.py": [{"type": "method", "rank": "D", "lineno": 70, "complexity": 29, "classname": "HiveAtomicSwapManager", "endline": 247, "name": "_test_connections", "col_offset": 4, "closures": [{"type": "function", "rank": "A", "lineno": 182, "complexity": 2, "endline": 192, "name": "_connect_and_query", "col_offset": 12, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 485, "complexity": 9, "classname": "HiveAtomicSwapManager", "endline": 617, "name": "_atomic_swap_table_location", "col_offset": 4, "closures": []}, {"type": "class", "rank": "B", "lineno": 24, "complexity": 7, "endline": 728, "name": "HiveAtomicSwapManager", "col_offset": 0, "methods": [{"type": "method", "rank": "A", "lineno": 27, "complexity": 1, "classname": "HiveAtomicSwapManager", "endline": 52, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 54, "complexity": 6, "classname": "HiveAtomicSwapManager", "endline": 68, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "D", "lineno": 70, "complexity": 29, "classname": "HiveAtomicSwapManager", "endline": 247, "name": "_test_connections", "col_offset": 4, "closures": [{"type": "function", "rank": "A", "lineno": 182, "complexity": 2, "endline": 192, "name": "_connect_and_query", "col_offset": 12, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 249, "complexity": 2, "classname": "HiveAtomicSwapManager", "endline": 367, "name": "_execute_sql_with_heartbeat", "col_offset": 4, "closures": [{"type": "function", "rank": "C", "lineno": 274, "complexity": 19, "endline": 344, "name": "_heartbeat", "col_offset": 8, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 369, "complexity": 2, "classname": "HiveAtomicSwapManager", "endline": 404, "name": "_atomic_table_swap", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 406, "complexity": 2, "classname": "HiveAtomicSwapManager", "endline": 481, "name": "_atomic_table_swap_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 485, "complexity": 9, "classname": "HiveAtomicSwapManager", "endline": 617, "name": "_atomic_swap_table_location", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 619, "complexity": 6, "classname": "HiveAtomicSwapManager", "endline": 688, "name": "_hdfs_rename_with_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 690, "complexity": 3, "classname": "HiveAtomicSwapManager", "endline": 728, "name": "_rollback_merge", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 54, "complexity": 6, "classname": "HiveAtomicSwapManager", "endline": 68, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 619, "complexity": 6, "classname": "HiveAtomicSwapManager", "endline": 688, "name": "_hdfs_rename_with_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 690, "complexity": 3, "classname": "HiveAtomicSwapManager", "endline": 728, "name": "_rollback_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 249, "complexity": 2, "classname": "HiveAtomicSwapManager", "endline": 367, "name": "_execute_sql_with_heartbeat", "col_offset": 4, "closures": [{"type": "function", "rank": "C", "lineno": 274, "complexity": 19, "endline": 344, "name": "_heartbeat", "col_offset": 8, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 369, "complexity": 2, "classname": "HiveAtomicSwapManager", "endline": 404, "name": "_atomic_table_swap", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 406, "complexity": 2, "classname": "HiveAtomicSwapManager", "endline": 481, "name": "_atomic_table_swap_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 27, "complexity": 1, "classname": "HiveAtomicSwapManager", "endline": 52, "name": "__init__", "col_offset": 4, "closures": []}], "app/engines/base_engine.py": [{"type": "method", "rank": "B", "lineno": 128, "complexity": 10, "classname": "BaseMergeEngine", "endline": 167, "name": "update_task_status", "col_offset": 4, "closures": []}, {"type": "class", "rank": "A", "lineno": 11, "complexity": 3, "endline": 179, "name": "BaseMergeEngine", "col_offset": 0, "methods": [{"type": "method", "rank": "A", "lineno": 17, "complexity": 1, "classname": "BaseMergeEngine", "endline": 18, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 21, "complexity": 1, "classname": "BaseMergeEngine", "endline": 29, "name": "validate_task", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 32, "complexity": 1, "classname": "BaseMergeEngine", "endline": 41, "name": "execute_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 44, "complexity": 1, "classname": "BaseMergeEngine", "endline": 52, "name": "get_merge_preview", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 55, "complexity": 1, "classname": "BaseMergeEngine", "endline": 63, "name": "estimate_duration", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 65, "complexity": 3, "classname": "BaseMergeEngine", "endline": 126, "name": "log_task_event", "col_offset": 4, "closures": [{"type": "function", "rank": "B", "lineno": 84, "complexity": 10, "endline": 107, "name": "_format_structured_msg", "col_offset": 8, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 128, "complexity": 10, "classname": "BaseMergeEngine", "endline": 167, "name": "update_task_status", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 169, "complexity": 1, "classname": "BaseMergeEngine", "endline": 179, "name": "_build_table_path", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 65, "complexity": 3, "classname": "BaseMergeEngine", "endline": 126, "name": "log_task_event", "col_offset": 4, "closures": [{"type": "function", "rank": "B", "lineno": 84, "complexity": 10, "endline": 107, "name": "_format_structured_msg", "col_offset": 8, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 17, "complexity": 1, "classname": "BaseMergeEngine", "endline": 18, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 21, "complexity": 1, "classname": "BaseMergeEngine", "endline": 29, "name": "validate_task", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 32, "complexity": 1, "classname": "BaseMergeEngine", "endline": 41, "name": "execute_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 44, "complexity": 1, "classname": "BaseMergeEngine", "endline": 52, "name": "get_merge_preview", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 55, "complexity": 1, "classname": "BaseMergeEngine", "endline": 63, "name": "estimate_duration", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 169, "complexity": 1, "classname": "BaseMergeEngine", "endline": 179, "name": "_build_table_path", "col_offset": 4, "closures": []}], "app/engines/connection_manager.py": [{"type": "method", "rank": "A", "lineno": 94, "complexity": 5, "classname": "HiveConnectionManager", "endline": 117, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "class", "rank": "A", "lineno": 20, "complexity": 4, "endline": 144, "name": "HiveConnectionManager", "col_offset": 0, "methods": [{"type": "method", "rank": "A", "lineno": 23, "complexity": 4, "classname": "HiveConnectionManager", "endline": 40, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 42, "complexity": 4, "classname": "HiveConnectionManager", "endline": 63, "name": "_init_hive_password", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 65, "complexity": 4, "classname": "HiveConnectionManager", "endline": 92, "name": "test_connections", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 94, "complexity": 5, "classname": "HiveConnectionManager", "endline": 117, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 119, "complexity": 2, "classname": "HiveConnectionManager", "endline": 123, "name": "get_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 125, "complexity": 4, "classname": "HiveConnectionManager", "endline": 138, "name": "cleanup_connections", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 140, "complexity": 1, "classname": "HiveConnectionManager", "endline": 141, "name": "__enter__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 143, "complexity": 1, "classname": "HiveConnectionManager", "endline": 144, "name": "__exit__", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 23, "complexity": 4, "classname": "HiveConnectionManager", "endline": 40, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 42, "complexity": 4, "classname": "HiveConnectionManager", "endline": 63, "name": "_init_hive_password", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 65, "complexity": 4, "classname": "HiveConnectionManager", "endline": 92, "name": "test_connections", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 125, "complexity": 4, "classname": "HiveConnectionManager", "endline": 138, "name": "cleanup_connections", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 119, "complexity": 2, "classname": "HiveConnectionManager", "endline": 123, "name": "get_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 140, "complexity": 1, "classname": "HiveConnectionManager", "endline": 141, "name": "__enter__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 143, "complexity": 1, "classname": "HiveConnectionManager", "endline": 144, "name": "__exit__", "col_offset": 4, "closures": []}], "app/engines/safe_hive_engine_refactored.py": [{"type": "class", "rank": "A", "lineno": 22, "complexity": 2, "endline": 86, "name": "SafeHiveMergeEngine", "col_offset": 0, "methods": [{"type": "method", "rank": "A", "lineno": 28, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 35, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 37, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 39, "name": "set_progress_callback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 41, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 43, "name": "validate_task", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 45, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 47, "name": "execute_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 49, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 51, "name": "get_merge_preview", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 53, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 55, "name": "estimate_duration", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 58, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 63, "name": "_execute_concatenate", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 65, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 70, "name": "_execute_insert_overwrite", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 72, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 77, "name": "_execute_safe_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 79, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 81, "name": "__enter__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 83, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 86, "name": "__exit__", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 83, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 86, "name": "__exit__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 28, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 35, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 37, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 39, "name": "set_progress_callback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 41, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 43, "name": "validate_task", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 45, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 47, "name": "execute_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 49, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 51, "name": "get_merge_preview", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 53, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 55, "name": "estimate_duration", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 58, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 63, "name": "_execute_concatenate", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 65, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 70, "name": "_execute_insert_overwrite", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 72, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 77, "name": "_execute_safe_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 79, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 81, "name": "__enter__", "col_offset": 4, "closures": []}], "app/engines/engine_factory.py": [{"type": "method", "rank": "B", "lineno": 62, "complexity": 9, "classname": "MergeEngineFactory", "endline": 108, "name": "recommend_strategy", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 234, "complexity": 9, "classname": "MergeEngineFactory", "endline": 253, "name": "_get_strategy_reason", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 111, "complexity": 7, "classname": "MergeEngineFactory", "endline": 165, "name": "validate_strategy_compatibility", "col_offset": 4, "closures": []}, {"type": "class", "rank": "B", "lineno": 8, "complexity": 6, "endline": 253, "name": "MergeEngineFactory", "col_offset": 0, "methods": [{"type": "method", "rank": "A", "lineno": 18, "complexity": 1, "classname": "MergeEngineFactory", "endline": 33, "name": "get_engine", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 36, "complexity": 1, "classname": "MergeEngineFactory", "endline": 58, "name": "get_engine_capabilities", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 62, "complexity": 9, "classname": "MergeEngineFactory", "endline": 108, "name": "recommend_strategy", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 111, "complexity": 7, "classname": "MergeEngineFactory", "endline": 165, "name": "validate_strategy_compatibility", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 168, "complexity": 6, "classname": "MergeEngineFactory", "endline": 229, "name": "create_smart_merge_task", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 234, "complexity": 9, "classname": "MergeEngineFactory", "endline": 253, "name": "_get_strategy_reason", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 168, "complexity": 6, "classname": "MergeEngineFactory", "endline": 229, "name": "create_smart_merge_task", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 18, "complexity": 1, "classname": "MergeEngineFactory", "endline": 33, "name": "get_engine", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 36, "complexity": 1, "classname": "MergeEngineFactory", "endline": 58, "name": "get_engine_capabilities", "col_offset": 4, "closures": []}], "app/engines/safe_hive_utils.py": [{"type": "class", "rank": "B", "lineno": 12, "complexity": 10, "endline": 170, "name": "HiveEngineUtils", "col_offset": 0, "methods": [{"type": "method", "rank": "B", "lineno": 43, "complexity": 10, "classname": "HiveEngineUtils", "endline": 120, "name": "extract_error_detail", "col_offset": 4, "closures": [{"type": "function", "rank": "B", "lineno": 57, "complexity": 6, "endline": 68, "name": "_append", "col_offset": 12, "closures": []}, {"type": "function", "rank": "B", "lineno": 70, "complexity": 7, "endline": 88, "name": "_extract_from_response", "col_offset": 12, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 123, "complexity": 7, "classname": "HiveEngineUtils", "endline": 170, "name": "get_format_classes", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 43, "complexity": 10, "classname": "HiveEngineUtils", "endline": 120, "name": "extract_error_detail", "col_offset": 4, "closures": [{"type": "function", "rank": "B", "lineno": 57, "complexity": 6, "endline": 68, "name": "_append", "col_offset": 12, "closures": []}, {"type": "function", "rank": "B", "lineno": 70, "complexity": 7, "endline": 88, "name": "_extract_from_response", "col_offset": 12, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 123, "complexity": 7, "classname": "HiveEngineUtils", "endline": 170, "name": "get_format_classes", "col_offset": 4, "closures": []}], "app/engines/safe_hive_engine.py": [{"type": "method", "rank": "F", "lineno": 298, "complexity": 57, "classname": "SafeHiveMergeEngine", "endline": 1047, "name": "execute_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "F", "lineno": 2294, "complexity": 41, "classname": "SafeHiveMergeEngine", "endline": 2574, "name": "_create_temp_table_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "D", "lineno": 1153, "complexity": 29, "classname": "SafeHiveMergeEngine", "endline": 1330, "name": "_test_connections", "col_offset": 4, "closures": [{"type": "function", "rank": "A", "lineno": 1265, "complexity": 2, "endline": 1275, "name": "_connect_and_query", "col_offset": 12, "closures": []}]}, {"type": "method", "rank": "C", "lineno": 3044, "complexity": 19, "classname": "SafeHiveMergeEngine", "endline": 3451, "name": "_execute_full_table_dynamic_partition_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1523, "complexity": 14, "classname": "SafeHiveMergeEngine", "endline": 1614, "name": "_get_partition_hdfs_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1421, "complexity": 13, "classname": "SafeHiveMergeEngine", "endline": 1472, "name": "_update_active_table_format", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 2892, "complexity": 13, "classname": "SafeHiveMergeEngine", "endline": 2991, "name": "_parse_table_schema_from_show_create", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 2780, "complexity": 12, "classname": "SafeHiveMergeEngine", "endline": 2831, "name": "_get_partition_columns", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 3757, "complexity": 12, "classname": "SafeHiveMergeEngine", "endline": 3896, "name": "_execute_partition_native_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1049, "complexity": 11, "classname": "SafeHiveMergeEngine", "endline": 1129, "name": "get_merge_preview", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 99, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 172, "name": "_extract_error_detail", "col_offset": 4, "closures": [{"type": "function", "rank": "B", "lineno": 109, "complexity": 6, "endline": 120, "name": "_append", "col_offset": 12, "closures": []}, {"type": "function", "rank": "B", "lineno": 122, "complexity": 7, "endline": 140, "name": "_extract_from_response", "col_offset": 12, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 234, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 296, "name": "validate_task", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1370, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 1419, "name": "_apply_output_settings", "col_offset": 4, "closures": [{"type": "function", "rank": "A", "lineno": 1386, "complexity": 1, "endline": 1397, "name": "_exec", "col_offset": 8, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 1478, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 1504, "name": "_partition_filter_to_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 3898, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 4098, "name": "_execute_single_partition_native_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 197, "complexity": 9, "classname": "SafeHiveMergeEngine", "endline": 232, "name": "_update_task_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 3453, "complexity": 9, "classname": "SafeHiveMergeEngine", "endline": 3585, "name": "_atomic_swap_table_location", "col_offset": 4, "closures": []}, {"type": "class", "rank": "B", "lineno": 27, "complexity": 8, "endline": 4098, "name": "SafeHiveMergeEngine", "col_offset": 0, "methods": [{"type": "method", "rank": "B", "lineno": 61, "complexity": 7, "classname": "SafeHiveMergeEngine", "endline": 93, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 95, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 97, "name": "set_progress_callback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 99, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 172, "name": "_extract_error_detail", "col_offset": 4, "closures": [{"type": "function", "rank": "B", "lineno": 109, "complexity": 6, "endline": 120, "name": "_append", "col_offset": 12, "closures": []}, {"type": "function", "rank": "B", "lineno": 122, "complexity": 7, "endline": 140, "name": "_extract_from_response", "col_offset": 12, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 176, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 179, "name": "_execute_concatenate", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 181, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 184, "name": "_execute_insert_overwrite", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 186, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 189, "name": "_execute_safe_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 191, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 195, "name": "_report_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 197, "complexity": 9, "classname": "SafeHiveMergeEngine", "endline": 232, "name": "_update_task_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 234, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 296, "name": "validate_task", "col_offset": 4, "closures": []}, {"type": "method", "rank": "F", "lineno": 298, "complexity": 57, "classname": "SafeHiveMergeEngine", "endline": 1047, "name": "execute_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1049, "complexity": 11, "classname": "SafeHiveMergeEngine", "endline": 1129, "name": "get_merge_preview", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1131, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 1151, "name": "estimate_duration", "col_offset": 4, "closures": []}, {"type": "method", "rank": "D", "lineno": 1153, "complexity": 29, "classname": "SafeHiveMergeEngine", "endline": 1330, "name": "_test_connections", "col_offset": 4, "closures": [{"type": "function", "rank": "A", "lineno": 1265, "complexity": 2, "endline": 1275, "name": "_connect_and_query", "col_offset": 12, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 1333, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 1351, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1353, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 1362, "name": "_cleanup_connections", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1370, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 1419, "name": "_apply_output_settings", "col_offset": 4, "closures": [{"type": "function", "rank": "A", "lineno": 1386, "complexity": 1, "endline": 1397, "name": "_exec", "col_offset": 8, "closures": []}]}, {"type": "method", "rank": "C", "lineno": 1421, "complexity": 13, "classname": "SafeHiveMergeEngine", "endline": 1472, "name": "_update_active_table_format", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1478, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 1504, "name": "_partition_filter_to_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1506, "complexity": 8, "classname": "SafeHiveMergeEngine", "endline": 1521, "name": "_split_or_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1523, "complexity": 14, "classname": "SafeHiveMergeEngine", "endline": 1614, "name": "_get_partition_hdfs_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1617, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 1652, "name": "_resolve_partition_path_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1654, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 1665, "name": "_resolve_partition_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1667, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 1681, "name": "_validate_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1683, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 1686, "name": "_generate_temp_table_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1688, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 1691, "name": "_generate_backup_table_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1693, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 1710, "name": "_init_merge_result_dict", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1713, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 1728, "name": "_determine_target_format", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1730, "complexity": 3, "classname": "SafeHiveMergeEngine", "endline": 1752, "name": "_normalize_compression_preference", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1754, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 1773, "name": "_should_use_dynamic_partition_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1775, "complexity": 3, "classname": "SafeHiveMergeEngine", "endline": 1800, "name": "_extract_parent_directory", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1802, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 1820, "name": "_build_shadow_root_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1822, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 1854, "name": "_calculate_effective_meta_compression", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1856, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 1879, "name": "_calculate_job_compression", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1881, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 1933, "name": "_create_temp_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1935, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 1981, "name": "_validate_temp_table_data", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1983, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2018, "name": "_atomic_table_swap", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 2020, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 2089, "name": "_hdfs_rename_with_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2091, "complexity": 3, "classname": "SafeHiveMergeEngine", "endline": 2129, "name": "_rollback_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2131, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 2173, "name": "_get_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2176, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 2217, "name": "_get_temp_table_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2219, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2232, "name": "_get_file_count_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2234, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 2292, "name": "_get_file_count_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "F", "lineno": 2294, "complexity": 41, "classname": "SafeHiveMergeEngine", "endline": 2574, "name": "_create_temp_table_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2576, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2698, "name": "_execute_sql_with_heartbeat", "col_offset": 4, "closures": [{"type": "function", "rank": "C", "lineno": 2601, "complexity": 19, "endline": 2671, "name": "_heartbeat", "col_offset": 8, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 2700, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2775, "name": "_atomic_table_swap_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 2780, "complexity": 12, "classname": "SafeHiveMergeEngine", "endline": 2831, "name": "_get_partition_columns", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 2833, "complexity": 8, "classname": "SafeHiveMergeEngine", "endline": 2872, "name": "_list_all_partitions", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2874, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2890, "name": "_parse_partition_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 2892, "complexity": 13, "classname": "SafeHiveMergeEngine", "endline": 2991, "name": "_parse_table_schema_from_show_create", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2993, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3042, "name": "_get_format_classes", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 3044, "complexity": 19, "classname": "SafeHiveMergeEngine", "endline": 3451, "name": "_execute_full_table_dynamic_partition_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 3453, "complexity": 9, "classname": "SafeHiveMergeEngine", "endline": 3585, "name": "_atomic_swap_table_location", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3587, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3605, "name": "_generate_temp_partition_kv", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3607, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3616, "name": "_format_partition_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3618, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 3633, "name": "_count_partition_files", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3635, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 3678, "name": "_wait_for_partition_data", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3680, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3708, "name": "_cleanup_temp_partition", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 3711, "complexity": 8, "classname": "SafeHiveMergeEngine", "endline": 3755, "name": "_get_non_partition_columns", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 3757, "complexity": 12, "classname": "SafeHiveMergeEngine", "endline": 3896, "name": "_execute_partition_native_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 3898, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 4098, "name": "_execute_single_partition_native_merge", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 1506, "complexity": 8, "classname": "SafeHiveMergeEngine", "endline": 1521, "name": "_split_or_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 2833, "complexity": 8, "classname": "SafeHiveMergeEngine", "endline": 2872, "name": "_list_all_partitions", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 3711, "complexity": 8, "classname": "SafeHiveMergeEngine", "endline": 3755, "name": "_get_non_partition_columns", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 61, "complexity": 7, "classname": "SafeHiveMergeEngine", "endline": 93, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1333, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 1351, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1617, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 1652, "name": "_resolve_partition_path_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1856, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 1879, "name": "_calculate_job_compression", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 2020, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 2089, "name": "_hdfs_rename_with_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1713, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 1728, "name": "_determine_target_format", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1822, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 1854, "name": "_calculate_effective_meta_compression", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2131, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 2173, "name": "_get_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2176, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 2217, "name": "_get_temp_table_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2234, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 2292, "name": "_get_file_count_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3635, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 3678, "name": "_wait_for_partition_data", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1353, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 1362, "name": "_cleanup_connections", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1667, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 1681, "name": "_validate_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1881, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 1933, "name": "_create_temp_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1935, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 1981, "name": "_validate_temp_table_data", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3618, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 3633, "name": "_count_partition_files", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1730, "complexity": 3, "classname": "SafeHiveMergeEngine", "endline": 1752, "name": "_normalize_compression_preference", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1775, "complexity": 3, "classname": "SafeHiveMergeEngine", "endline": 1800, "name": "_extract_parent_directory", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2091, "complexity": 3, "classname": "SafeHiveMergeEngine", "endline": 2129, "name": "_rollback_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 191, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 195, "name": "_report_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1131, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 1151, "name": "estimate_duration", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1754, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 1773, "name": "_should_use_dynamic_partition_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1802, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 1820, "name": "_build_shadow_root_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1983, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2018, "name": "_atomic_table_swap", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2219, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2232, "name": "_get_file_count_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2576, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2698, "name": "_execute_sql_with_heartbeat", "col_offset": 4, "closures": [{"type": "function", "rank": "C", "lineno": 2601, "complexity": 19, "endline": 2671, "name": "_heartbeat", "col_offset": 8, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 2700, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2775, "name": "_atomic_table_swap_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2874, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2890, "name": "_parse_partition_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2993, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3042, "name": "_get_format_classes", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3587, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3605, "name": "_generate_temp_partition_kv", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3607, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3616, "name": "_format_partition_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3680, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3708, "name": "_cleanup_temp_partition", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 95, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 97, "name": "set_progress_callback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 176, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 179, "name": "_execute_concatenate", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 181, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 184, "name": "_execute_insert_overwrite", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 186, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 189, "name": "_execute_safe_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1654, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 1665, "name": "_resolve_partition_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1683, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 1686, "name": "_generate_temp_table_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1688, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 1691, "name": "_generate_backup_table_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1693, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 1710, "name": "_init_merge_result_dict", "col_offset": 4, "closures": []}], "app/engines/safe_hive_file_counter.py": [{"type": "method", "rank": "B", "lineno": 39, "complexity": 6, "classname": "HiveFileCounter", "endline": 56, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "class", "rank": "A", "lineno": 18, "complexity": 5, "endline": 311, "name": "HiveFileCounter", "col_offset": 0, "methods": [{"type": "method", "rank": "A", "lineno": 21, "complexity": 1, "classname": "HiveFileCounter", "endline": 37, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 39, "complexity": 6, "classname": "HiveFileCounter", "endline": 56, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 58, "complexity": 5, "classname": "HiveFileCounter", "endline": 100, "name": "_get_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 103, "complexity": 5, "classname": "HiveFileCounter", "endline": 161, "name": "_get_file_count_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 163, "complexity": 2, "classname": "HiveFileCounter", "endline": 176, "name": "_get_file_count_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 178, "complexity": 5, "classname": "HiveFileCounter", "endline": 219, "name": "_get_temp_table_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 221, "complexity": 4, "classname": "HiveFileCounter", "endline": 236, "name": "_count_partition_files", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 238, "complexity": 5, "classname": "HiveFileCounter", "endline": 281, "name": "_wait_for_partition_data", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 283, "complexity": 2, "classname": "HiveFileCounter", "endline": 311, "name": "_cleanup_temp_partition", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 58, "complexity": 5, "classname": "HiveFileCounter", "endline": 100, "name": "_get_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 103, "complexity": 5, "classname": "HiveFileCounter", "endline": 161, "name": "_get_file_count_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 178, "complexity": 5, "classname": "HiveFileCounter", "endline": 219, "name": "_get_temp_table_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 238, "complexity": 5, "classname": "HiveFileCounter", "endline": 281, "name": "_wait_for_partition_data", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 221, "complexity": 4, "classname": "HiveFileCounter", "endline": 236, "name": "_count_partition_files", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 163, "complexity": 2, "classname": "HiveFileCounter", "endline": 176, "name": "_get_file_count_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 283, "complexity": 2, "classname": "HiveFileCounter", "endline": 311, "name": "_cleanup_temp_partition", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 21, "complexity": 1, "classname": "HiveFileCounter", "endline": 37, "name": "__init__", "col_offset": 4, "closures": []}], "app/engines/real_hive_engine.py": [{"type": "method", "rank": "C", "lineno": 536, "complexity": 13, "classname": "RealHiveMergeEngine", "endline": 594, "name": "_create_real_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1162, "complexity": 12, "classname": "RealHiveMergeEngine", "endline": 1249, "name": "get_merge_preview", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 75, "complexity": 9, "classname": "RealHiveMergeEngine", "endline": 110, "name": "_update_task_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 112, "complexity": 9, "classname": "RealHiveMergeEngine", "endline": 167, "name": "validate_task", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 29, "complexity": 7, "classname": "RealHiveMergeEngine", "endline": 63, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 732, "complexity": 7, "classname": "RealHiveMergeEngine", "endline": 825, "name": "_create_real_temp_table_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 169, "complexity": 6, "classname": "RealHiveMergeEngine", "endline": 505, "name": "execute_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 507, "complexity": 6, "classname": "RealHiveMergeEngine", "endline": 534, "name": "_test_connections", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 610, "complexity": 6, "classname": "RealHiveMergeEngine", "endline": 630, "name": "_is_partitioned_table", "col_offset": 4, "closures": []}, {"type": "class", "rank": "A", "lineno": 22, "complexity": 5, "endline": 1274, "name": "RealHiveMergeEngine", "col_offset": 0, "methods": [{"type": "method", "rank": "B", "lineno": 29, "complexity": 7, "classname": "RealHiveMergeEngine", "endline": 63, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 65, "complexity": 1, "classname": "RealHiveMergeEngine", "endline": 67, "name": "set_progress_callback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 69, "complexity": 2, "classname": "RealHiveMergeEngine", "endline": 73, "name": "_report_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 75, "complexity": 9, "classname": "RealHiveMergeEngine", "endline": 110, "name": "_update_task_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 112, "complexity": 9, "classname": "RealHiveMergeEngine", "endline": 167, "name": "validate_task", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 169, "complexity": 6, "classname": "RealHiveMergeEngine", "endline": 505, "name": "execute_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 507, "complexity": 6, "classname": "RealHiveMergeEngine", "endline": 534, "name": "_test_connections", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 536, "complexity": 13, "classname": "RealHiveMergeEngine", "endline": 594, "name": "_create_real_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 596, "complexity": 2, "classname": "RealHiveMergeEngine", "endline": 608, "name": "_table_exists", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 610, "complexity": 6, "classname": "RealHiveMergeEngine", "endline": 630, "name": "_is_partitioned_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 632, "complexity": 5, "classname": "RealHiveMergeEngine", "endline": 651, "name": "_validate_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 653, "complexity": 1, "classname": "RealHiveMergeEngine", "endline": 656, "name": "_generate_temp_table_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 658, "complexity": 1, "classname": "RealHiveMergeEngine", "endline": 661, "name": "_generate_backup_table_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 663, "complexity": 2, "classname": "RealHiveMergeEngine", "endline": 671, "name": "_get_table_location", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 673, "complexity": 5, "classname": "RealHiveMergeEngine", "endline": 730, "name": "_get_real_file_count_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 732, "complexity": 7, "classname": "RealHiveMergeEngine", "endline": 825, "name": "_create_real_temp_table_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 827, "complexity": 2, "classname": "RealHiveMergeEngine", "endline": 933, "name": "_execute_sql_with_heartbeat", "col_offset": 4, "closures": [{"type": "function", "rank": "D", "lineno": 847, "complexity": 21, "endline": 912, "name": "_heartbeat", "col_offset": 8, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 935, "complexity": 4, "classname": "RealHiveMergeEngine", "endline": 986, "name": "_validate_real_temp_table_data", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 988, "complexity": 5, "classname": "RealHiveMergeEngine", "endline": 1027, "name": "_get_real_temp_table_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1029, "complexity": 2, "classname": "RealHiveMergeEngine", "endline": 1107, "name": "_real_atomic_table_swap_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1109, "complexity": 3, "classname": "RealHiveMergeEngine", "endline": 1150, "name": "_rollback_real_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1152, "complexity": 3, "classname": "RealHiveMergeEngine", "endline": 1160, "name": "_cleanup_connections", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1162, "complexity": 12, "classname": "RealHiveMergeEngine", "endline": 1249, "name": "get_merge_preview", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1251, "complexity": 2, "classname": "RealHiveMergeEngine", "endline": 1274, "name": "estimate_duration", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 632, "complexity": 5, "classname": "RealHiveMergeEngine", "endline": 651, "name": "_validate_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 673, "complexity": 5, "classname": "RealHiveMergeEngine", "endline": 730, "name": "_get_real_file_count_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 988, "complexity": 5, "classname": "RealHiveMergeEngine", "endline": 1027, "name": "_get_real_temp_table_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 935, "complexity": 4, "classname": "RealHiveMergeEngine", "endline": 986, "name": "_validate_real_temp_table_data", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1109, "complexity": 3, "classname": "RealHiveMergeEngine", "endline": 1150, "name": "_rollback_real_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1152, "complexity": 3, "classname": "RealHiveMergeEngine", "endline": 1160, "name": "_cleanup_connections", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 69, "complexity": 2, "classname": "RealHiveMergeEngine", "endline": 73, "name": "_report_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 596, "complexity": 2, "classname": "RealHiveMergeEngine", "endline": 608, "name": "_table_exists", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 663, "complexity": 2, "classname": "RealHiveMergeEngine", "endline": 671, "name": "_get_table_location", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 827, "complexity": 2, "classname": "RealHiveMergeEngine", "endline": 933, "name": "_execute_sql_with_heartbeat", "col_offset": 4, "closures": [{"type": "function", "rank": "D", "lineno": 847, "complexity": 21, "endline": 912, "name": "_heartbeat", "col_offset": 8, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 1029, "complexity": 2, "classname": "RealHiveMergeEngine", "endline": 1107, "name": "_real_atomic_table_swap_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1251, "complexity": 2, "classname": "RealHiveMergeEngine", "endline": 1274, "name": "estimate_duration", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 65, "complexity": 1, "classname": "RealHiveMergeEngine", "endline": 67, "name": "set_progress_callback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 653, "complexity": 1, "classname": "RealHiveMergeEngine", "endline": 656, "name": "_generate_temp_table_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 658, "complexity": 1, "classname": "RealHiveMergeEngine", "endline": 661, "name": "_generate_backup_table_name", "col_offset": 4, "closures": []}], "app/engines/merge_executor.py": [{"type": "method", "rank": "C", "lineno": 129, "complexity": 18, "classname": "MergeTaskExecutor", "endline": 303, "name": "_execute_unified_merge_impl", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 305, "complexity": 11, "classname": "MergeTaskExecutor", "endline": 334, "name": "_get_table_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 336, "complexity": 9, "classname": "MergeTaskExecutor", "endline": 361, "name": "_get_table_format", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 369, "complexity": 9, "classname": "MergeTaskExecutor", "endline": 404, "name": "_update_task_progress", "col_offset": 4, "closures": []}, {"type": "class", "rank": "B", "lineno": 22, "complexity": 7, "endline": 450, "name": "MergeTaskExecutor", "col_offset": 0, "methods": [{"type": "method", "rank": "A", "lineno": 25, "complexity": 1, "classname": "MergeTaskExecutor", "endline": 28, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 30, "complexity": 1, "classname": "MergeTaskExecutor", "endline": 32, "name": "set_progress_callback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 34, "complexity": 5, "classname": "MergeTaskExecutor", "endline": 126, "name": "execute_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 129, "complexity": 18, "classname": "MergeTaskExecutor", "endline": 303, "name": "_execute_unified_merge_impl", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 305, "complexity": 11, "classname": "MergeTaskExecutor", "endline": 334, "name": "_get_table_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 336, "complexity": 9, "classname": "MergeTaskExecutor", "endline": 361, "name": "_get_table_format", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 363, "complexity": 2, "classname": "MergeTaskExecutor", "endline": 367, "name": "_report_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 369, "complexity": 9, "classname": "MergeTaskExecutor", "endline": 404, "name": "_update_task_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 406, "complexity": 4, "classname": "MergeTaskExecutor", "endline": 418, "name": "_partition_filter_to_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 420, "complexity": 4, "classname": "MergeTaskExecutor", "endline": 435, "name": "_resolve_partition_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 437, "complexity": 4, "classname": "MergeTaskExecutor", "endline": 450, "name": "_validate_shadow_directory", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 34, "complexity": 5, "classname": "MergeTaskExecutor", "endline": 126, "name": "execute_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 406, "complexity": 4, "classname": "MergeTaskExecutor", "endline": 418, "name": "_partition_filter_to_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 420, "complexity": 4, "classname": "MergeTaskExecutor", "endline": 435, "name": "_resolve_partition_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 437, "complexity": 4, "classname": "MergeTaskExecutor", "endline": 450, "name": "_validate_shadow_directory", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 363, "complexity": 2, "classname": "MergeTaskExecutor", "endline": 367, "name": "_report_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 25, "complexity": 1, "classname": "MergeTaskExecutor", "endline": 28, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 30, "complexity": 1, "classname": "MergeTaskExecutor", "endline": 32, "name": "set_progress_callback", "col_offset": 4, "closures": []}], "app/engines/safe_hive_engine_original_backup.py": [{"type": "method", "rank": "F", "lineno": 294, "complexity": 76, "classname": "SafeHiveMergeEngine", "endline": 1091, "name": "execute_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "F", "lineno": 2389, "complexity": 44, "classname": "SafeHiveMergeEngine", "endline": 2673, "name": "_create_temp_table_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "D", "lineno": 1197, "complexity": 29, "classname": "SafeHiveMergeEngine", "endline": 1374, "name": "_test_connections", "col_offset": 4, "closures": [{"type": "function", "rank": "A", "lineno": 1309, "complexity": 2, "endline": 1319, "name": "_connect_and_query", "col_offset": 12, "closures": []}]}, {"type": "method", "rank": "C", "lineno": 3170, "complexity": 19, "classname": "SafeHiveMergeEngine", "endline": 3451, "name": "_execute_full_table_dynamic_partition_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1720, "complexity": 18, "classname": "SafeHiveMergeEngine", "endline": 1759, "name": "_get_table_columns", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1466, "complexity": 15, "classname": "SafeHiveMergeEngine", "endline": 1516, "name": "_get_table_format_info", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1659, "complexity": 15, "classname": "SafeHiveMergeEngine", "endline": 1690, "name": "_is_unsupported_table_type", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1692, "complexity": 15, "classname": "SafeHiveMergeEngine", "endline": 1718, "name": "_unsupported_reason", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1806, "complexity": 14, "classname": "SafeHiveMergeEngine", "endline": 1897, "name": "_get_partition_hdfs_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1605, "complexity": 13, "classname": "SafeHiveMergeEngine", "endline": 1656, "name": "_update_active_table_format", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 3018, "complexity": 13, "classname": "SafeHiveMergeEngine", "endline": 3117, "name": "_parse_table_schema_from_show_create", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 2906, "complexity": 12, "classname": "SafeHiveMergeEngine", "endline": 2957, "name": "_get_partition_columns", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 3757, "complexity": 12, "classname": "SafeHiveMergeEngine", "endline": 3896, "name": "_execute_partition_native_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1093, "complexity": 11, "classname": "SafeHiveMergeEngine", "endline": 1173, "name": "get_merge_preview", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1528, "complexity": 11, "classname": "SafeHiveMergeEngine", "endline": 1552, "name": "_infer_table_compression", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 95, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 168, "name": "_extract_error_detail", "col_offset": 4, "closures": [{"type": "function", "rank": "B", "lineno": 105, "complexity": 6, "endline": 116, "name": "_append", "col_offset": 12, "closures": []}, {"type": "function", "rank": "B", "lineno": 118, "complexity": 7, "endline": 136, "name": "_extract_from_response", "col_offset": 12, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 230, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 292, "name": "validate_task", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1554, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 1603, "name": "_apply_output_settings", "col_offset": 4, "closures": [{"type": "function", "rank": "A", "lineno": 1570, "complexity": 1, "endline": 1581, "name": "_exec", "col_offset": 8, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 1761, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 1787, "name": "_partition_filter_to_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 3898, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 4098, "name": "_execute_single_partition_native_merge", "col_offset": 4, "closures": []}, {"type": "class", "rank": "B", "lineno": 26, "complexity": 9, "endline": 4098, "name": "SafeHiveMergeEngine", "col_offset": 0, "methods": [{"type": "method", "rank": "B", "lineno": 60, "complexity": 7, "classname": "SafeHiveMergeEngine", "endline": 89, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 91, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 93, "name": "set_progress_callback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 95, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 168, "name": "_extract_error_detail", "col_offset": 4, "closures": [{"type": "function", "rank": "B", "lineno": 105, "complexity": 6, "endline": 116, "name": "_append", "col_offset": 12, "closures": []}, {"type": "function", "rank": "B", "lineno": 118, "complexity": 7, "endline": 136, "name": "_extract_from_response", "col_offset": 12, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 172, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 175, "name": "_execute_concatenate", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 177, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 180, "name": "_execute_insert_overwrite", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 182, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 185, "name": "_execute_safe_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 187, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 191, "name": "_report_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 193, "complexity": 9, "classname": "SafeHiveMergeEngine", "endline": 228, "name": "_update_task_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 230, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 292, "name": "validate_task", "col_offset": 4, "closures": []}, {"type": "method", "rank": "F", "lineno": 294, "complexity": 76, "classname": "SafeHiveMergeEngine", "endline": 1091, "name": "execute_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1093, "complexity": 11, "classname": "SafeHiveMergeEngine", "endline": 1173, "name": "get_merge_preview", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1175, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 1195, "name": "estimate_duration", "col_offset": 4, "closures": []}, {"type": "method", "rank": "D", "lineno": 1197, "complexity": 29, "classname": "SafeHiveMergeEngine", "endline": 1374, "name": "_test_connections", "col_offset": 4, "closures": [{"type": "function", "rank": "A", "lineno": 1309, "complexity": 2, "endline": 1319, "name": "_connect_and_query", "col_offset": 12, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 1376, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 1384, "name": "_get_table_location", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1386, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 1404, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1406, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 1415, "name": "_cleanup_connections", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1417, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 1428, "name": "_table_exists", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1430, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 1450, "name": "_is_partitioned_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1452, "complexity": 3, "classname": "SafeHiveMergeEngine", "endline": 1464, "name": "_get_table_partitions", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1466, "complexity": 15, "classname": "SafeHiveMergeEngine", "endline": 1516, "name": "_get_table_format_info", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1518, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 1526, "name": "_infer_storage_format_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1528, "complexity": 11, "classname": "SafeHiveMergeEngine", "endline": 1552, "name": "_infer_table_compression", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1554, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 1603, "name": "_apply_output_settings", "col_offset": 4, "closures": [{"type": "function", "rank": "A", "lineno": 1570, "complexity": 1, "endline": 1581, "name": "_exec", "col_offset": 8, "closures": []}]}, {"type": "method", "rank": "C", "lineno": 1605, "complexity": 13, "classname": "SafeHiveMergeEngine", "endline": 1656, "name": "_update_active_table_format", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1659, "complexity": 15, "classname": "SafeHiveMergeEngine", "endline": 1690, "name": "_is_unsupported_table_type", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1692, "complexity": 15, "classname": "SafeHiveMergeEngine", "endline": 1718, "name": "_unsupported_reason", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1720, "complexity": 18, "classname": "SafeHiveMergeEngine", "endline": 1759, "name": "_get_table_columns", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1761, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 1787, "name": "_partition_filter_to_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1789, "complexity": 8, "classname": "SafeHiveMergeEngine", "endline": 1804, "name": "_split_or_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 1806, "complexity": 14, "classname": "SafeHiveMergeEngine", "endline": 1897, "name": "_get_partition_hdfs_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1900, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 1935, "name": "_resolve_partition_path_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1937, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 1948, "name": "_resolve_partition_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1950, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 1964, "name": "_validate_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1966, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 1969, "name": "_generate_temp_table_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1971, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 1974, "name": "_generate_backup_table_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1976, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 2028, "name": "_create_temp_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2030, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 2076, "name": "_validate_temp_table_data", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2078, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2113, "name": "_atomic_table_swap", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 2115, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 2184, "name": "_hdfs_rename_with_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2186, "complexity": 3, "classname": "SafeHiveMergeEngine", "endline": 2224, "name": "_rollback_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2226, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 2268, "name": "_get_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2271, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 2312, "name": "_get_temp_table_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2314, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2327, "name": "_get_file_count_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2329, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 2387, "name": "_get_file_count_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "F", "lineno": 2389, "complexity": 44, "classname": "SafeHiveMergeEngine", "endline": 2673, "name": "_create_temp_table_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2675, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2793, "name": "_execute_sql_with_heartbeat", "col_offset": 4, "closures": [{"type": "function", "rank": "C", "lineno": 2700, "complexity": 19, "endline": 2770, "name": "_heartbeat", "col_offset": 8, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 2795, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2870, "name": "_atomic_table_swap_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2874, "complexity": 3, "classname": "SafeHiveMergeEngine", "endline": 2904, "name": "_is_partitioned_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 2906, "complexity": 12, "classname": "SafeHiveMergeEngine", "endline": 2957, "name": "_get_partition_columns", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 2959, "complexity": 8, "classname": "SafeHiveMergeEngine", "endline": 2998, "name": "_list_all_partitions", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3000, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3016, "name": "_parse_partition_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 3018, "complexity": 13, "classname": "SafeHiveMergeEngine", "endline": 3117, "name": "_parse_table_schema_from_show_create", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3119, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3168, "name": "_get_format_classes", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 3170, "complexity": 19, "classname": "SafeHiveMergeEngine", "endline": 3451, "name": "_execute_full_table_dynamic_partition_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 3453, "complexity": 9, "classname": "SafeHiveMergeEngine", "endline": 3585, "name": "_atomic_swap_table_location", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3587, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3605, "name": "_generate_temp_partition_kv", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3607, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3616, "name": "_format_partition_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3618, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 3633, "name": "_count_partition_files", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3635, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 3678, "name": "_wait_for_partition_data", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3680, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3708, "name": "_cleanup_temp_partition", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 3711, "complexity": 8, "classname": "SafeHiveMergeEngine", "endline": 3755, "name": "_get_non_partition_columns", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 3757, "complexity": 12, "classname": "SafeHiveMergeEngine", "endline": 3896, "name": "_execute_partition_native_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 3898, "complexity": 10, "classname": "SafeHiveMergeEngine", "endline": 4098, "name": "_execute_single_partition_native_merge", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "B", "lineno": 193, "complexity": 9, "classname": "SafeHiveMergeEngine", "endline": 228, "name": "_update_task_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 3453, "complexity": 9, "classname": "SafeHiveMergeEngine", "endline": 3585, "name": "_atomic_swap_table_location", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1789, "complexity": 8, "classname": "SafeHiveMergeEngine", "endline": 1804, "name": "_split_or_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 2959, "complexity": 8, "classname": "SafeHiveMergeEngine", "endline": 2998, "name": "_list_all_partitions", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 3711, "complexity": 8, "classname": "SafeHiveMergeEngine", "endline": 3755, "name": "_get_non_partition_columns", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 60, "complexity": 7, "classname": "SafeHiveMergeEngine", "endline": 89, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1386, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 1404, "name": "_create_hive_connection", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1430, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 1450, "name": "_is_partitioned_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1518, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 1526, "name": "_infer_storage_format_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 1900, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 1935, "name": "_resolve_partition_path_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 2115, "complexity": 6, "classname": "SafeHiveMergeEngine", "endline": 2184, "name": "_hdfs_rename_with_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2226, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 2268, "name": "_get_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2271, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 2312, "name": "_get_temp_table_file_count", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2329, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 2387, "name": "_get_file_count_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3635, "complexity": 5, "classname": "SafeHiveMergeEngine", "endline": 3678, "name": "_wait_for_partition_data", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1406, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 1415, "name": "_cleanup_connections", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1950, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 1964, "name": "_validate_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1976, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 2028, "name": "_create_temp_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2030, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 2076, "name": "_validate_temp_table_data", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3618, "complexity": 4, "classname": "SafeHiveMergeEngine", "endline": 3633, "name": "_count_partition_files", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1452, "complexity": 3, "classname": "SafeHiveMergeEngine", "endline": 1464, "name": "_get_table_partitions", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2186, "complexity": 3, "classname": "SafeHiveMergeEngine", "endline": 2224, "name": "_rollback_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2874, "complexity": 3, "classname": "SafeHiveMergeEngine", "endline": 2904, "name": "_is_partitioned_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 187, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 191, "name": "_report_progress", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1175, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 1195, "name": "estimate_duration", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1376, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 1384, "name": "_get_table_location", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1417, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 1428, "name": "_table_exists", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2078, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2113, "name": "_atomic_table_swap", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2314, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2327, "name": "_get_file_count_fallback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 2675, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2793, "name": "_execute_sql_with_heartbeat", "col_offset": 4, "closures": [{"type": "function", "rank": "C", "lineno": 2700, "complexity": 19, "endline": 2770, "name": "_heartbeat", "col_offset": 8, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 2795, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 2870, "name": "_atomic_table_swap_with_logging", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3000, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3016, "name": "_parse_partition_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3119, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3168, "name": "_get_format_classes", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3587, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3605, "name": "_generate_temp_partition_kv", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3607, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3616, "name": "_format_partition_spec", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 3680, "complexity": 2, "classname": "SafeHiveMergeEngine", "endline": 3708, "name": "_cleanup_temp_partition", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 91, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 93, "name": "set_progress_callback", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 172, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 175, "name": "_execute_concatenate", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 177, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 180, "name": "_execute_insert_overwrite", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 182, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 185, "name": "_execute_safe_merge", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1937, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 1948, "name": "_resolve_partition_path", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1966, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 1969, "name": "_generate_temp_table_name", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 1971, "complexity": 1, "classname": "SafeHiveMergeEngine", "endline": 1974, "name": "_generate_backup_table_name", "col_offset": 4, "closures": []}], "app/engines/validation_service.py": [{"type": "method", "rank": "C", "lineno": 120, "complexity": 14, "classname": "MergeTaskValidationService", "endline": 157, "name": "_is_unsupported_table_type", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 21, "complexity": 9, "classname": "MergeTaskValidationService", "endline": 73, "name": "validate_task", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 159, "complexity": 8, "classname": "MergeTaskValidationService", "endline": 177, "name": "_unsupported_reason", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 202, "complexity": 7, "classname": "MergeTaskValidationService", "endline": 231, "name": "get_table_columns", "col_offset": 4, "closures": []}, {"type": "class", "rank": "B", "lineno": 15, "complexity": 6, "endline": 231, "name": "MergeTaskValidationService", "col_offset": 0, "methods": [{"type": "method", "rank": "A", "lineno": 18, "complexity": 1, "classname": "MergeTaskValidationService", "endline": 19, "name": "__init__", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 21, "complexity": 9, "classname": "MergeTaskValidationService", "endline": 73, "name": "validate_task", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 75, "complexity": 2, "classname": "MergeTaskValidationService", "endline": 85, "name": "_table_exists", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 87, "complexity": 2, "classname": "MergeTaskValidationService", "endline": 95, "name": "_is_partitioned_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 97, "complexity": 3, "classname": "MergeTaskValidationService", "endline": 107, "name": "_get_table_partitions", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 109, "complexity": 2, "classname": "MergeTaskValidationService", "endline": 118, "name": "_get_table_format_info", "col_offset": 4, "closures": []}, {"type": "method", "rank": "C", "lineno": 120, "complexity": 14, "classname": "MergeTaskValidationService", "endline": 157, "name": "_is_unsupported_table_type", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 159, "complexity": 8, "classname": "MergeTaskValidationService", "endline": 177, "name": "_unsupported_reason", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 179, "complexity": 5, "classname": "MergeTaskValidationService", "endline": 200, "name": "_validate_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "B", "lineno": 202, "complexity": 7, "classname": "MergeTaskValidationService", "endline": 231, "name": "get_table_columns", "col_offset": 4, "closures": []}]}, {"type": "method", "rank": "A", "lineno": 179, "complexity": 5, "classname": "MergeTaskValidationService", "endline": 200, "name": "_validate_partition_filter", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 97, "complexity": 3, "classname": "MergeTaskValidationService", "endline": 107, "name": "_get_table_partitions", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 75, "complexity": 2, "classname": "MergeTaskValidationService", "endline": 85, "name": "_table_exists", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 87, "complexity": 2, "classname": "MergeTaskValidationService", "endline": 95, "name": "_is_partitioned_table", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 109, "complexity": 2, "classname": "MergeTaskValidationService", "endline": 118, "name": "_get_table_format_info", "col_offset": 4, "closures": []}, {"type": "method", "rank": "A", "lineno": 18, "complexity": 1, "classname": "MergeTaskValidationService", "endline": 19, "name": "__init__", "col_offset": 4, "closures": []}]}
